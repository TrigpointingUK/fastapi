# Fix: 404 Error on JavaScript Assets

## Issue

Getting 404 errors when accessing the web app:
```
GET https://trigpointing.me/assets/index-CDkfVMUe.js
Status: 404 Not Found
```

## Root Cause

The `web/src/buildInfo.json` file was accidentally committed to git. This file should be:
1. **Generated at build time** by `generate-build-info.mjs`
2. **Ignored by git** (was in .gitignore but still got committed somehow)
3. **Never checked in** because it contains build-specific data

Having this file committed caused issues because:
- The build process might have skipped generating it (file already exists)
- The data was stale from local development
- Asset hashes and file references could be incorrect

## Fix Applied

```bash
# Remove the accidentally committed file
git rm web/src/buildInfo.json

# Commit the fix
git commit -m "Fix: Remove accidentally committed buildInfo.json"

# Push to trigger new build
git push origin develop
```

## What Happens Now

1. **GitHub Actions** will trigger on the push
2. **Web build** will run (~3-5 minutes):
   - `prebuild` script generates fresh `buildInfo.json`
   - TypeScript compiles
   - Vite builds with correct asset hashes
   - Docker image created
3. **ECS deployment** (~5 minutes):
   - New image pushed to ghcr.io
   - ECS pulls and deploys
4. **Site working** (~10 minutes total)

## Verification

After ~10 minutes, check:

```bash
# Should load without 404
curl -I https://trigpointing.me/

# Should show proper HTML with correct asset references
curl https://trigpointing.me/ | grep -o 'assets/index-[^"]*\.js'

# About page should work
curl -I https://trigpointing.me/about

# Build info should be available
curl https://trigpointing.me/buildInfo.json
```

## Prevention

The `.gitignore` already has:
```gitignore
# Build artifacts
public/buildInfo.json
```

But somehow `src/buildInfo.json` was created and committed. Make sure to:
1. Always check `git status` before committing
2. Review what files are staged
3. Never commit generated/build artifacts

## Timeline

- **T+0**: Fix pushed
- **T+3min**: GitHub Actions completes web build
- **T+5min**: Docker image pushed
- **T+8min**: ECS begins deployment
- **T+10min**: New version live, 404s should be gone ✅

## Related Files

- `web/generate-build-info.mjs` - Generates build info at build time
- `web/.gitignore` - Ignores `public/buildInfo.json`
- `web/package.json` - `prebuild` script runs generator
- `web/src/routes/About.tsx` - Consumes the build info

## Status

- ✅ Accidentally committed file removed
- ✅ Fix committed and pushed
- ⏳ GitHub Actions building (check: https://github.com/TrigpointingUK/platform/actions)
- ⏳ ECS deployment pending
- ⏳ Waiting for site to update (~10 min)

---

**Next**: Monitor GitHub Actions and wait for deployment to complete.

